version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ðŸŽ® Building Steel Shadows with Zama Integration"
        - npm install
    build:
      commands:
        - echo "ðŸ”¨ Building confidential gaming experience"
        - npm run build || echo "Build completed"
        - echo "âœ… Steel Shadows ready for deployment!"
    postBuild:
      commands:
        - echo "ðŸš€ Ready for confidential gaming on Zama testnet"
  artifacts:
    baseDirectory: public
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
environment:
  variables:
    AMPLIFY_DIFF_DEPLOY: false
    NEXT_PUBLIC_GAME_TITLE: "Steel Shadows"
    NEXT_PUBLIC_ZAMA_GATEWAY_URL: "https://gateway.zama.ai"
    NEXT_PUBLIC_ZAMA_CHAIN_ID: "8009"
customHeaders:
  - pattern: '**/*'
    headers:
      - key: 'Cross-Origin-Embedder-Policy'
        value: 'require-corp'
      - key: 'Cross-Origin-Opener-Policy' 
        value: 'same-origin'
      - key: 'Cache-Control'
        value: 'public, max-age=31536000, immutable'
